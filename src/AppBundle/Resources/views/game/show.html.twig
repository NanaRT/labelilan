{% extends 'base.html.twig' %}

{% block body %}
    <div class="container">
        <div class="row">
            <!-- Blog Post Content Column -->
            <div class="col-lg-8">
                <h1>{{game.name}}</h1>
                <p class="lead">
                	{{game.category.name}} organisé par <a href="{{ path('informations') }}#{{game.organizer.systName}}">{{game.organizer.name}}</a>
                </p>
                <hr>
                <img src="{{ asset('bundles/app/img/game/'~game.systName~'.png') }}" alt="{{game.name}}" class="img-responsive" >
                <hr>
                <p>
                	{{game.description}}
                </p>

            </div>

            <div class="col-md-4">
                <div class="well">
                    <div class="input-group">
	                	<h4>
	                		Places
	                	</h4>
	                	{%if game.category.systName == 'multi' %}
	                		Nb places équipes restantes : {{ searchCategoryService.getMultiPlaces(game.id) }}
	                	{% elseif game.category.systName == 'solo'
	                	and game.places%}
	                		Nb places restantes : {{ searchCategoryService.getSoloPlaces(game.id) }}
	                	{% else%}
							Nb personnes intéressées : {{ searchCategoryService.getNumberPlayer(game.id) }}
	                    {%endif%} 
	                    <br>
	                    {% if (is_granted("IS_AUTHENTICATED_REMEMBERED")) %} 
	                    	{% if  (game.category.systName == 'multi' or game.category.systName == 'solo')%}
								{%if searchCategoryService.checkPlaces(game.id) == 1
								and searchCategoryService.getCreatedPlayer(app.user.id, game.id) == 0%}
				                    <a class="btn btn-default" href="{{path('player_new', {'userId':app.user.id, 'gameId':game.id}) }}" >
				                    	 <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> S'inscrire
				                    </a>
				                {%else%}
				                    <a class="btn btn-default disabled" href="{{path('player_new', {'userId':app.user.id, 'gameId':game.id}) }}" >
				                    	 Inscrit
				                    </a>
				                {%endif%}
							{% elseif game.category.systName == 'autre'
							or game.category.systName == 'libre'%}
								{%if searchCategoryService.getCreatedPlayer(app.user.id, game.id) == 0%}
				                    <a class="btn btn-default" href="{{path('new_free_player', {'userId':app.user.id, 'gameId':game.id}) }}" >
				                    	 <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Intéréssé
				                    </a>
				                {%else%}
				                    <a class="btn btn-default disabled" href="{{path('new_free_player', {'userId':app.user.id, 'gameId':game.id}) }}" >
				                    	 Intéréssé
				                    </a>
				                {%endif%}
				            {%endif%}
			            {%endif%}
                    </div>
                </div>

                {% if (is_granted("IS_AUTHENTICATED_REMEMBERED")) %} 
	            	{% if  (game.category.systName == 'multi')   %}
	            		{%for player in searchCategoryService.getPlayerGame(app.user.id, game.id)%}
							{%if player.team 
							and player.team.validation is null 
							and player.capitain%}
				                <div class="well">  
				                	<h4>Rechercher joueur</h4>
				                	<table class="table table-hover">
					                	{%for soloPlayers in searchCategoryService.searchSoloPlayers(game.id)%}
					                		<tr>
					                			<td>
					                				{{soloPlayers.name}}
					                			</td>
					                			<td>
					                			</td>
					                		</tr>
					                	{%endfor%}
				                	</tableW
				                </div>
							{%else%}	            			
				                <div class="well">  
				                	<h4>Créer team</h4>
				                	<a class="btn btn-default" href="{{path('team_new', {'user':app.user.id, 'game':game.id}) }}" >
				                    	 <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Créer une équipe
				                    </a>
				                </div>
				            {%endif%}
			            {%endfor%}
                	{%endif%}
                {%endif%}

                <!-- Side Widget Well -->
                <div class="well">
                    <h4>Side Widget Well</h4>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore, perspiciatis adipisci accusamus laudantium odit aliquam repellat tempore quos aspernatur vero.</p>
                </div>

            </div>

    </div>

	{% if is_granted("ROLE_ADMIN") %}
        {{ form_start(delete_form) }}
            <input class="btn btn-default" type="submit" value="Delete">
        {{ form_end(delete_form) }}
    {%endif%}
    
{% endblock %}
